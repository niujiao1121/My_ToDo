# Scripts 目录

本目录包含用于 TODO 管理的辅助脚本。

## 📊 visualize_todos.py

可视化 GitHub Issues 的树状结构，显示任务的优先级、截止日期、模块和从属关系。

### 功能特性

- 🌳 **树状结构展示**：清晰显示项目和任务的层级关系
- 🏷️ **优先级标识**：使用颜色标记不同优先级（紧急、重要、中等、低）
- ⏰ **截止日期提醒**：显示任务的截止日期，并标记即将到期的任务
- 📦 **模块分类**：显示任务所属模块（前端、后端、数据库等）
- ✅ **状态追踪**：区分已完成和未完成的任务
- 📈 **统计信息**：提供任务数量、优先级分布、模块分布等统计数据

### 安装依赖

```bash
pip install requests
```

### 使用方法

#### 1. 获取 GitHub Token

首先需要创建一个 GitHub Personal Access Token：

1. 访问 https://github.com/settings/tokens
2. 点击 "Generate new token (classic)"
3. 勾选 `repo` 权限
4. 生成并复制 token

#### 2. 设置环境变量

```bash
export GITHUB_TOKEN=your_token_here
```

或者在 Windows 上：

```cmd
set GITHUB_TOKEN=your_token_here
```

#### 3. 运行脚本

**在仓库目录中运行（自动检测仓库）：**

```bash
python scripts/visualize_todos.py
```

**指定仓库：**

```bash
python scripts/visualize_todos.py --owner niujiao1121 --repo My_ToDo
```

**直接提供 token（不使用环境变量）：**

```bash
python scripts/visualize_todos.py --token your_token_here
```

### 输出示例

```
================================================================================
📊 TODO 层级结构可视化 - niujiao1121/My_ToDo
================================================================================

🎯 项目列表
--------------------------------------------------------------------------------
└── ◯ #10 [PROJECT] 博客系统开发 (📦 项目, 🟠重要, ⏰2024-12-31)
    ├── ◯ #15 [TASK] 用户认证系统 (⏰ 有期限, 🟠重要, [后端], ⏰2024-12-25)
    │   ├── ✓ #20 [SUBTASK] 实现用户注册 API (📌 子任务, 🟡中等, [后端])
    │   └── ◯ #21 [SUBTASK] 实现用户登录 API (📌 子任务, 🟡中等, [后端])
    └── ◯ #16 [TASK] 文章管理功能 (⏰ 有期限, 🟡中等, [前端], ⏰2024-12-30)

📋 独立任务列表
--------------------------------------------------------------------------------
├── ◯ #5 [TASK] 学习 Docker (🔓 开放性, 🟡中等, [运维])
└── ✓ #3 [TASK] 完成周报 (⏰ 有期限, 🟡中等, [文档])

================================================================================
📈 统计信息
================================================================================

总任务数: 8
  - 进行中/未完成: 5
  - 已完成: 3

按优先级（未完成）:
  - 重要: 2
  - 中等: 3

按模块（未完成）:
  - 后端: 2
  - 前端: 1
  - 运维: 1

⚠️  即将到期的任务（7天内）:
  - #15: 用户认证系统 (截止: 2024-12-25, 1天后)
```

### 输出说明

- **◯** - 未完成的任务
- **✓** - 已完成的任务
- **🔴** - 紧急优先级
- **🟠** - 重要优先级
- **🟡** - 中等优先级
- **🟢** - 低优先级
- **⚪** - 未设置优先级
- **📦 项目** - 大型项目
- **⏰ 有期限** - 有截止日期的任务
- **🔓 开放性** - 开放性任务
- **📌 子任务** - 子任务

### 注意事项

1. **Token 权限**：确保 GitHub Token 有 `repo` 权限
2. **API 限制**：GitHub API 有速率限制（认证用户每小时 5000 次请求），正常使用不会超出
3. **父子关系识别**：脚本会自动识别 Issue body 中的 `**Parent Issue**: #数字` 标记
4. **私有仓库**：如果仓库是私有的，token 需要有访问该仓库的权限

### 故障排除

**问题：提示 "需要安装 requests 库"**
```bash
pip install requests
```

**问题：提示 "需要提供 GitHub Token"**
- 确保已设置 `GITHUB_TOKEN` 环境变量
- 或使用 `--token` 参数直接提供

**问题：提示 "无法获取 Issues"**
- 检查 token 是否有效
- 检查 token 是否有 `repo` 权限
- 检查仓库名称是否正确

**问题：显示的父子关系不正确**
- 检查 Issue body 中的父任务标记格式是否正确
- 确保使用 `**Parent Issue**: #数字` 格式

### 进阶用法

#### 定期生成报告

创建一个 cron 任务或 GitHub Action，定期运行脚本并保存输出：

```bash
python scripts/visualize_todos.py > todo_report_$(date +%Y%m%d).txt
```

#### 过滤特定类型的任务

可以修改脚本，添加过滤功能，只显示特定标签、优先级或模块的任务。

#### 导出为其他格式

可以扩展脚本，支持导出为 JSON、HTML、Markdown 等格式，便于集成到其他工具中。

## 📝 贡献

欢迎提交 Issue 或 Pull Request 来改进脚本功能！

## 📄 许可

与主项目保持一致。
